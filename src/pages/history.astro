---
import PrefetchLinks from "@/components/PrefetchLinks.astro";
import Button from "@/components/ui/Button.astro";
import TopBar from "@/components/ui/TopBar.astro";
import PageLayout from "@/layouts/PageLayout.astro";
import { HomeViewAnimation } from "@/utils/ViewAnimation";
---

<PageLayout
	title="WhiteboardScanner - Verlauf"
	pageID="historyPage"
	viewAnimation={HomeViewAnimation}
>
	<TopBar>
		<a onclick="history.back()" style="margin-left: auto">
			<i class="fa-solid fa-xmark closeBtn"></i>
		</a>
	</TopBar>
	<h1>
		<i class="fa-solid fa-clock-rotate-left"></i>Verlauf
	</h1>
	<ul>
		<p>Dienstag, 18.11.2025</p>
		<li>
			<span id="date">
				<i class="fa-regular fa-clock"></i>17:36 Uhr
			</span>
			<p><span>PhiMai</span> hat dir einen PushShare gesendet</p>
			<span id="fileName">
				<i class="fa-solid fa-image"></i>IMG_0543455434.png
			</span>
			<img src="/bertie.jpg" />
		</li>
		<li>
			<span id="date">
				<i class="fa-regular fa-clock"></i>17:36 Uhr
			</span>
			<p><span>PhiMai</span> hat dir einen PushShare gesendet</p>
			<span id="fileName">
				<i class="fa-solid fa-image"></i>IMG_0543455434.png
			</span>
			<img src="/bertie.jpg" />
		</li>
		<p>Dienstag, 18.11.2025</p>
		<li>
			<span id="date">
				<i class="fa-regular fa-clock"></i>17:36 Uhr
			</span>
			<p><span>PhiMai</span> hat dir einen PushShare gesendet</p>
			<span id="fileName">
				<i class="fa-solid fa-image"></i>IMG_0543455434.png
			</span>
			<img src="/bertie.jpg" />
		</li>
		<p>Dienstag, 18.11.2025</p>
		<li>
			<span id="date">
				<i class="fa-regular fa-clock"></i>17:36 Uhr
			</span>
			<p><span>PhiMai</span> hat dir einen PushShare gesendet</p>
			<span id="fileName">
				<i class="fa-solid fa-image"></i>IMG_0543455434.png
			</span>
			<img src="/bertie.jpg" />
		</li>
		<p>Dienstag, 18.11.2025</p>
		<li>
			<span id="date">
				<i class="fa-regular fa-clock"></i>17:36 Uhr
			</span>
			<p><span>PhiMai</span> hat dir einen PushShare gesendet</p>
			<span id="fileName">
				<i class="fa-solid fa-image"></i>IMG_0543455434.png
			</span>
			<img src="/bertie.jpg" />
		</li>
	</ul>
</PageLayout>

<style lang="scss">
	:global(#historyPage) {
		//overflow-y: scroll !important;
		//touch-action: manipulation !important;
		//background-color: blue !important;
	}

	h1 {
		display: flex;
		justify-content: center;
		align-items: center;
		gap: 0.5rem;
		//margin-bottom: 3rem;
		font-size: 2.5rem;
		width: 100%;
		margin-bottom: 2.5rem;

		> i {
			font-size: 2rem;
		}
	}

	ul {
		display: flex;
		flex-direction: column;
		gap: 1rem;

		list-style: none;

		> p {
			color: darken(white, 30%);
			/* font-size: 1rem;
			display: flex;
			align-items: center;
			gap: 0.25rem; */

			&:not(:first-of-type) {
				margin-top: 1.5rem;
			}

			flex-shrink: 0;

			display: flex;
			align-items: center;
			white-space: nowrap;
			gap: 1rem;

			&::before,
			&::after {
				content: "";
				position: relative;
				width: 100%;
				height: 1px;

				flex-shrink: 1;

				//background-color: darken(white, 50%) !important;
				border-radius: 9999rem;
			}

			&::before {
				background: linear-gradient(
					90deg,
					transparent,
					darken(white, 50%) 50%
				);
			}

			&::after {
				background: linear-gradient(
					90deg,
					darken(white, 50%) 50%,
					transparent
				);
			}
		}

		li {
			position: relative;
			font-size: 1.5rem;
			padding-block: 1rem;

			//background-color: #151718;
			//border-radius: 1rem;

			p {
				//margin-bottom: -0.25rem;
				> span {
					color: orange;
				}
			}

			> span {
				color: darken(white, 30%);
				font-size: 1rem;
				display: flex;
				align-items: center;
				gap: 0.25rem;

				&#date {
					font-size: 1.25rem;

					margin-bottom: 0.25rem;

					i {
						font-size: 1.25rem;
					}
				}

				&#fileName {
					//margin-bottom: 1rem;
				}
			}

			> img {
				position: absolute;
				right: 0px;
				top: 0px;
				max-width: min(100%, 30rem);
				max-height: 100%;
				object-fit: contain;
				cursor: pointer;

				border-radius: 1rem;
			}
		}
	}
</style>

<script>
	import { storedDeviceUUID } from "@/stores/store";
	import { createInitSwapFunction } from "@/utils/InitSwapFunction";

	createInitSwapFunction(() => {
		window.sendSocketRequest(
			{
				id: "GET_HISTORY",
				device_uuid: storedDeviceUUID.get(),
			},
			(response: any) => {
				console.log("History RESPONSE", response);
			},
		);
	}, "/history");
</script>
